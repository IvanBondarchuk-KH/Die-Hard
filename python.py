import sys
import random

characters = {
    "1": {
        "name": "–î–∂–æ–Ω –ú–∞–∫–ö–ª–µ–π–Ω",
        "hp": 120,
        "accuracy": 0.6,
        "stealth": 0.8,
        "ammo": 15,
        "weapon": "–ø—ñ—Å—Ç–æ–ª–µ—Ç",
        "passive": "never_give_up",
        "desc": "–í–∏—Ç—Ä–∏–≤–∞–ª–∏–π. –í–∏–∂–∏–≤–∞–Ω–Ω—è, —ñ–º–ø—Ä–æ–≤—ñ–∑–∞—Ü—ñ—è. –î–æ–≤–≥–æ –∂–∏–≤–µ –±–µ–∑ —Ä–µ—Å—É—Ä—Å—ñ–≤. –ü–∞—Å–∏–≤–∫–∞: –∫–æ–ª–∏ HP < 30% ‚Üí +20% –¥–æ —É—Ö–∏–ª–µ–Ω–Ω—è."
    },
    "2": {
        "name": "–ê–ª—å –ü–∞—É–µ–ª–ª",
        "hp": 100,
        "accuracy": 0.7,
        "stealth": 0.4,
        "ammo": 6,
        "weapon": "—Ä–µ–≤–æ–ª—å–≤–µ—Ä",
        "passive": "radio_support",
        "desc": "–ü—ñ–¥—Ç—Ä–∏–º–∫–∞. –î–∏–ø–ª–æ–º–∞—Ç—ñ—è, –¥–æ–ø–æ–º–æ–≥–∞, —Ä–µ—Å—É—Ä—Å–∏. –ü–∞—Å–∏–≤–∫–∞: —Ä–∞–∑ –∑–∞ —Å—Ü–µ–Ω—É –≤–∏–∫–ª–∏–∫–∞—Ç–∏ –¥–æ–ø–æ–º–æ–≥—É. –£–Ω—ñ–∫–∞–ª—å–Ω—ñ –¥—ñ–∞–ª–æ–≥–∏."
    },
    "3": {
        "name": "–°–µ–∫‚Äô—é—Ä—ñ—Ç—ñ Nakatomi",
        "hp": 90,
        "accuracy": 0.75,
        "stealth": 0.6,
        "ammo": 4,
        "weapon": "–¥—Ä–æ–±–æ–≤–∏–∫",
        "passive": "building_plans",
        "desc": "–¢–∞–∫—Ç–∏–∫. –ö–æ–Ω—Ç—Ä–æ–ª—å —Ç–µ—Ä–∏—Ç–æ—Ä—ñ—ó. –ü–∞—Å–∏–≤–∫–∞: –∑–Ω–∞—î —Å–µ–∫—Ä–µ—Ç–Ω—ñ –ø—Ä–æ—Ö–æ–¥–∏. –ë—ñ–ª—å—à–µ –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤ –ø–µ—Ä–µ–º—ñ—â–µ–Ω–Ω—è."
    }
}

def choose_character():
    print("–í–∏–±–µ—Ä—ñ—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞:")
    for key, char in characters.items():
        print(f"{key}. {char['name']} ‚Äî {char['desc']}")
    while True:
        choice = input("–í–∞—à –≤–∏–±—ñ—Ä (1/2/3): ").strip()
        if choice in characters:
            return characters[choice]
        print("–ù–µ–∫–æ—Ä–µ–∫—Ç–Ω–∏–π –≤–∏–±—ñ—Ä. –°–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑.")

def init_player(char):
    return {
        "name": char["name"],
        "hp": char["hp"],
        "accuracy": char["accuracy"],
        "stealth": char["stealth"],
        "ammo": char["ammo"],
        "weapon": char["weapon"],
        "passive": char["passive"],
        "medkits": 1,
        "radio": 1,
        "noise": 0,
        "time": 100
    }

def first_scene(player):
    print("\nüìú –ü–µ—Ä–µ–¥—ñ—Å—Ç–æ—Ä—ñ—è: –†—ñ–∑–¥–≤–æ. –ù—ñ—á. –¢–∏ ‚Äî –∫–æ–ø —É —Ü–∏–≤—ñ–ª—å–Ω–æ–º—É –Ω–∞ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ñ–π –≤–µ—á—ñ—Ä—Ü—ñ. –ß–µ—Ä–µ–∑ 10 —Ö–≤–∏–ª–∏–Ω –±—É–¥—ñ–≤–ª—é –∑–∞—Ö–æ–ø–ª—è—Ç—å —Ç–µ—Ä–æ—Ä–∏—Å—Ç–∏.")
    print(f"–¢–∏ –≥—Ä–∞—î—à –∑–∞: {player['name']}")
    print(f"HP: {player['hp']} | –¢–æ—á–Ω—ñ—Å—Ç—å: {int(player['accuracy']*100)}% | –°—Ç–µ–ª—Å: {int(player['stealth']*100)}% | –ó–±—Ä–æ—è: {player['weapon']} ({player['ammo']} –Ω–∞–±–æ—ó–≤)")
    print(f"–ê–ø—Ç–µ—á–∫–∏: {player['medkits']} | –†–∞—Ü—ñ—è: {player['radio']} | –ß–∞—Å: {player['time']} | –®—É–º: {player['noise']}")
    print("\n–õ—ñ—Ñ—Ç –∑–∞—á–∏–Ω—è—î—Ç—å—Å—è. –°–≤—ñ—Ç–ª–æ –º–µ—Ä–µ—Ö—Ç–∏—Ç—å. –ó–Ω–∏–∑—É —á—É—Ç–∏ –∞–≤—Ç–æ–º–∞—Ç–Ω—É —á–µ—Ä–≥—É. –¢–∏ —â–µ –º–æ–∂–µ—à –≤—Ç–µ–∫—Ç–∏‚Ä¶ –∞–±–æ –∑–∞–ª–∏—à–∏—Ç–∏—Å—å.")
    print("\n–©–æ —Ä–æ–±–∏—Ç–∏?")
    print("1. üèÉ –í–∏–π—Ç–∏ –∑ –±—É–¥—ñ–≤–ª—ñ –∑–∞—Ä–∞–∑")
    print("2. üïµÔ∏è –ó–∞–ª–∏—à–∏—Ç–∏—Å—å —ñ —Ä–æ–∑–≤—ñ–¥–∞—Ç–∏ –ø–æ–≤–µ—Ä—Ö")
    print("3. üìû –°–ø—Ä–æ–±—É–≤–∞—Ç–∏ –∑–≤‚Äô—è–∑–∞—Ç–∏—Å—å —ñ–∑ –∑–æ–≤–Ω—ñ—à–Ω—ñ–º —Å–≤—ñ—Ç–æ–º")
    while True:
        action = input("–í–∞—à –≤–∏–±—ñ—Ä (1/2/3): ").strip()
        if action in ("1", "2", "3"):
            return action
        print("–ù–µ–∫–æ—Ä–µ–∫—Ç–Ω–∏–π –≤–∏–±—ñ—Ä. –°–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑.")

def process_first_scene_choice(player, action):
    if action == "1":
        player["time"] -= 10
        player["ending"] = "coward_escape"
        player["alive"] = True
        print("\n–í–∏ –∫–æ—Ä–∏—Å—Ç—É—î—Ç–µ—Å—å –∞–≤–∞—Ä—ñ–π–Ω–∏–º–∏ —Å—Ö–æ–¥–∞–º–∏. –û—Ö–æ—Ä–æ–Ω–∞ –∑–∞–π–Ω—è—Ç–∞ –µ–≤–∞–∫—É–∞—Ü—ñ—î—é. –í–∏ –∑–Ω–∏–∫–∞—î—Ç–µ –≤ –Ω–∞—Ç–æ–≤–ø—ñ.")
        print("\n–ö–Ü–ù–ï–¶–¨: –í–∏ –≤–∏–∂–∏–ª–∏, –∞–ª–µ —Ç–µ—Ä–æ—Ä–∏—Å—Ç–∏ —Ä–µ–∞–ª—ñ–∑—É–≤–∞–ª–∏ —Å–≤—ñ–π –ø–ª–∞–Ω. –ü–æ–≥–∞–Ω–∞ –∫—ñ–Ω—Ü—ñ–≤–∫–∞.")
    elif action == "2":
        player["time"] -= 5
        player["noise"] += 5
        player["intel_unlocked"] = True
        player["location"] = "office_floor"
        print("\n–í–∏ –≤–∏–º–∏–∫–∞—î—Ç–µ —Å–≤—ñ—Ç–ª–æ –≤ –æ—Ñ—ñ—Å—ñ. –ü–æ–≤–µ—Ä—Ö –ø–æ—Ä–æ–∂–Ω—ñ–π, –∞–ª–µ —á—É—Ç–∏ –∫—Ä–æ–∫–∏ –∑ –∫–æ—Ä–∏–¥–æ—Ä—É.")
        print("–í–∏ –∑–∞–ª–∏—à–∞—î—Ç–µ—Å—å –Ω–µ–≤—ñ–¥–æ–º–∏–º —Ñ–∞–∫—Ç–æ—Ä–æ–º. –í—ñ–¥–∫—Ä–∏–≤–∞—î—Ç—å—Å—è –≥—ñ–ª–∫–∞ stealth-–≥—Ä–∏.")
        print("–î–æ—Å—Ç—É–ø–Ω—ñ –Ω–æ–≤—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ: –∑–∞—Å—ñ–¥–∫–∏, —Å–µ–∫—Ä–µ—Ç–Ω—ñ –º–∞—Ä—à—Ä—É—Ç–∏, —Å–∞–±–æ—Ç–∞–∂.")
    elif action == "3":
        player["time"] -= 8
        player["noise"] += 15
        player["police_alerted"] = True
        player["radio_used"] = True
        print("\n–†–∞—Ü—ñ—è –ª–æ–≤–∏—Ç—å –ø–µ—Ä–µ—à–∫–æ–¥–∏. –°–∏–≥–Ω–∞–ª –Ω–µ—Å—Ç–∞–±—ñ–ª—å–Ω–∏–π. –•—Ç–æ—Å—å –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î‚Ä¶ –∞–ª–µ –∑–∞–ø—ñ–∑–Ω–æ.")
        print("–ü–æ–ª—ñ—Ü—ñ—è –±—É–¥–µ –∑–Ω–∞—Ç–∏ –ø—Ä–æ –∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è. –¢–µ—Ä–æ—Ä–∏—Å—Ç–∏ –º–æ–∂—É—Ç—å –∑–∞—Å—ñ–∫—Ç–∏ —Å–∏–≥–Ω–∞–ª.")
        if player["noise"] > 50:
            player["terrorists_alerted"] = True
            print("–¢–µ—Ä–æ—Ä–∏—Å—Ç–∏ –∑–∞—Å—ñ–∫–ª–∏ —Å–∏–≥–Ω–∞–ª! –°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å –∑—Ä–æ—Å—Ç–∞—î.")
    else:
        print("\n–ù–µ–≤—ñ–¥–æ–º–∞ –¥—ñ—è. –°—Ç–∞–Ω –Ω–µ –∑–º—ñ–Ω–µ–Ω–æ.")
    return player

def scene2_office_floor(player):
    print("\n–í–∏ –Ω–∞ –æ—Ñ—ñ—Å–Ω–æ–º—É –ø–æ–≤–µ—Ä—Å—ñ. –°–≤—ñ—Ç–ª–æ –≤–∏–º–∫–Ω–µ–Ω–µ. –ß—É—Ç–∏ –ø–∞—Ç—Ä—É–ª—å —É –∫–æ—Ä–∏–¥–æ—Ä—ñ.")
    print("1. –¢–∏—Ö–æ –æ–±—à—É–∫–∞—Ç–∏ –æ—Ñ—ñ—Å")
    print("2. –ü—Ä–æ—Å–ª—É—Ö–∞—Ç–∏ —Ä–æ–∑–º–æ–≤—É –ø–∞—Ç—Ä—É–ª—è")
    print("3. –ù–∞–ø–∞—Å—Ç–∏ –Ω–∞ –ø–∞—Ç—Ä—É–ª—å —ñ–∑ –∑–∞—Å—ñ–¥–∫–∏")
    print("4. –£–Ω–∏–∫–Ω—É—Ç–∏ –∫–æ–Ω—Ç–∞–∫—Ç—É —ñ –∑–º—ñ–Ω–∏—Ç–∏ –ø–æ–≤–µ—Ä—Ö")
    while True:
        action = input("–í–∞—à –≤–∏–±—ñ—Ä (1/2/3/4): ").strip()
        if action == "1":
            player["time"] -= 10
            player["noise"] += 5
            player["ammo"] += 8
            player["medkits"] += 1
            player["intel_found"] = True
            if random.random() < 0.15:
                player["noise"] += 20
                print("\n–©–æ—Å—å –≤–ø–∞–ª–æ! –®—É–º —Ä—ñ–∑–∫–æ –∑—Ä—ñ—Å.")
            print("\n–í–∏ –æ–±—à—É–∫–∞–ª–∏ –æ—Ñ—ñ—Å —ñ –∑–Ω–∞–π—à–ª–∏ —Ä–µ—Å—É—Ä—Å–∏. –í–∏ –≤—Å–µ —â–µ –≤ —Ç—ñ–Ω—ñ.")
            break
        elif action == "2":
            player["time"] -= 6
            player["intel_safe_location"] = True
            player["intel_roof_plan"] = True
            print("\n–í–∏ –¥—ñ–∑–Ω–∞–ª–∏—Å—å –ø—Ä–æ —Å–µ–π—Ñ —ñ –ø–ª–∞–Ω —Ç–µ—Ä–æ—Ä–∏—Å—Ç—ñ–≤ —â–æ–¥–æ –¥–∞—Ö—É. –ú—ñ–Ω—ñ–º—É–º —Ä–∏–∑–∏–∫—É, –º–∞–∫—Å–∏–º—É–º –∫–æ—Ä–∏—Å—Ç—ñ.")
            break
        elif action == "3":
            player["time"] -= 5
            player["ammo"] -= 1
            player["noise"] += 25
            player["enemy_killed"] = player.get("enemy_killed", 0) + 1
            player["terrorist_suspicion"] = True
            print("\n–í–∏ –Ω–∞–ø–∞–ª–∏ —ñ–∑ –∑–∞—Å—ñ–¥–∫–∏. –ü–µ—Ä—à–∏–π –≤–æ—Ä–æ–≥ –∑–Ω–∏—â–µ–Ω–∏–π, –∞–ª–µ —à—É–º —ñ –ø—ñ–¥–æ–∑—Ä–∞ –∑—Ä–æ—Å–ª–∏.")
            break
        elif action == "4":
            player["time"] -= 12
            player["location"] = "ventilation"
            print("\n–í–∏ —É–Ω–∏–∫–∞—î—Ç–µ –∫–æ–Ω—Ç–∞–∫—Ç—É —ñ –ø–æ–≤–∑–µ—Ç–µ –≤–µ–Ω—Ç–∏–ª—è—Ü—ñ—î—é –¥–æ —ñ–Ω—à–æ–≥–æ –∫—Ä–∏–ª–∞.")
            break
        else:
            print("–ù–µ–∫–æ—Ä–µ–∫—Ç–Ω–∏–π –≤–∏–±—ñ—Ä. –°–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑.")
    return player

def scene3_radio_branch(player):
    print("\n–ü–æ–ª—ñ—Ü—ñ—è –ø–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–∞. –°–∏–≥–Ω–∞–ª –Ω–µ—Å—Ç–∞–±—ñ–ª—å–Ω–∏–π. –¢–µ—Ä–æ—Ä–∏—Å—Ç–∏ –º–æ–∂—É—Ç—å –≤–∞—Å –∑–∞—Å—ñ–∫—Ç–∏.")
    print("1. –ü—Ä–æ–¥–æ–≤–∂–∏—Ç–∏ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é")
    print("2. –ó–º—ñ–Ω–∏—Ç–∏ –ø–æ–∑–∏—Ü—ñ—é –ø—ñ—Å–ª—è –≤–∏–∫–ª–∏–∫—É")
    print("3. –ó—Ä–æ–±–∏—Ç–∏ —Ñ–µ–π–∫–æ–≤–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è")
    print("4. –í–∏–º–∫–Ω—É—Ç–∏ —Ä–∞—Ü—ñ—é —ñ –∑–∞—Ç–∞—ó—Ç–∏—Å—å")
    while True:
        action = input("–í–∞—à –≤–∏–±—ñ—Ä (1/2/3/4): ").strip()
        if action == "1":
            player["time"] -= 10
            player["noise"] += 20
            player["police_prepared"] = True
            print("\n–í–∏ –ø–µ—Ä–µ–¥–∞–ª–∏ –ø–æ–ª—ñ—Ü—ñ—ó –ø–ª–∞–Ω–∏ –±—É–¥—ñ–≤–ª—ñ. –§—ñ–Ω–∞–ª —Å—Ç–∞–Ω–µ –ª–µ–≥—à–∏–º, –∞–ª–µ –≤–∞—Å –º–æ–∂—É—Ç—å –≤–∏—è–≤–∏—Ç–∏.")
            break
        elif action == "2":
            player["time"] -= 8
            player["noise"] += 10
            player["location"] = "stairs"
            print("\n–í–∏ –∑–º—ñ–Ω–∏–ª–∏ –ø–æ–∑–∏—Ü—ñ—é –æ–¥—Ä–∞–∑—É –ø—ñ—Å–ª—è –≤–∏–∫–ª–∏–∫—É. –ú—ñ–Ω—ñ–º—ñ–∑—É—î—Ç–µ —Ä–∏–∑–∏–∫ –≤–∏—è–≤–ª–µ–Ω–Ω—è.")
            break
        elif action == "3":
            player["time"] -= 6
            player["noise"] += 15
            player["terrorist_confused"] = True
            player["police_confused"] = True
            print("\n–í–∏ –∑—Ä–æ–±–∏–ª–∏ —Ñ–µ–π–∫–æ–≤–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è. –¢–µ—Ä–æ—Ä–∏—Å—Ç–∏ –¥–µ–∑–æ—Ä—ñ—î–Ω—Ç–æ–≤–∞–Ω—ñ, –∞–ª–µ –ø–æ–ª—ñ—Ü—ñ—è —Ç–µ–∂.")
            break
        elif action == "4":
            player["time"] -= 4
            player["noise"] = max(0, player["noise"] - 5)
            player["radio_off"] = True
            print("\n–í–∏ –≤–∏–º–∫–Ω—É–ª–∏ —Ä–∞—Ü—ñ—é —ñ –∑–∞—Ç–∞—ó–ª–∏—Å—å. –ü–æ–ª—ñ—Ü—ñ—è –¥—ñ—è—Ç–∏–º–µ –ø–æ–≤—ñ–ª—å–Ω—ñ—à–µ.")
            break
        else:
            print("–ù–µ–∫–æ—Ä–µ–∫—Ç–Ω–∏–π –≤–∏–±—ñ—Ä. –°–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑.")
    return player

def check_alert_mode(player):
    if player.get("noise", 0) > 70 or player.get("terrorists_alerted"):
        print("\nüî¥ ALERT! –¢–µ—Ä–æ—Ä–∏—Å—Ç–∏ –∑–Ω–∞—é—Ç—å –ø—Ä–æ –≤–∞—à—É –ø—Ä–∏—Å—É—Ç–Ω—ñ—Å—Ç—å. –í–æ–Ω–∏ –Ω–µ –∑–Ω–∞—é—Ç—å, –¥–µ –≤–∏, –∞–ª–µ –ø–∞—Ç—Ä—É–ª—ñ –ø–æ—Å–∏–ª–µ–Ω—ñ!")
        player["enemy_patrols"] = player.get("enemy_patrols", 0) + 2
        player["stealth_difficulty"] = "HIGH"
        player["combat_frequency"] = "HIGH"
    return player

def post_2_1(player):
    player["time"] -= 5
    player["intel_roof_explosives"] = True
    player["side_objective_unlocked"] = True
    return player

def post_2_2(player):
    player["time"] -= 3
    player["ambush_avoided"] = True
    player["boss_location_known"] = True
    return player

def post_2_3(player):
    player["time"] -= 4
    player["enemy_search_mode"] = True
    player["noise"] += 15
    return player

def post_2_4(player):
    player["time"] -= 6
    player["intel_lockdown"] = True
    player["future_routes_limited"] = True
    return player

def post_3_1(player):
    player["time"] -= 5
    player["terrorists_alerted"] = True
    player["final_enemy_count"] = player.get("final_enemy_count", 0) - 2
    return player

def post_3_2(player):
    player["time"] -= 2
    player["enemy_time_wasted"] = True
    player["noise"] = max(0, player["noise"] - 5)
    return player

def post_3_3(player):
    player["midgame_difficulty"] = player.get("midgame_difficulty", 0) - 1
    player["final_difficulty"] = player.get("final_difficulty", 0) + 1
    return player

def post_3_4(player):
    player["police_help_disabled"] = True
    player["stealth_bonus"] = 0.1
    return player

def post_alert_1(player):
    player["time"] -= 5
    player["noise"] += 10
    player["map_control"] = player.get("map_control", 0) - 1
    return player

def post_alert_2(player):
    player["time"] -= 8
    player["next_combat_damage"] = player.get("next_combat_damage", 0) + 30
    player["enemy_count"] = player.get("enemy_count", 0) - 1
    return player

def post_alert_3(player):
    player["time"] -= 3
    player["ammo"] = max(0, player["ammo"] - 4)
    player["hp"] -= random.randint(10, 25)
    player["combat_started"] = True
    return player

def post_alert_4(player, stealth_success=True):
    player["time"] -= 10
    if not stealth_success:
        player["combat_started"] = True
    else:
        player["alert_level"] = player.get("alert_level", 0) - 1
    return player

scene_graph = {
    "2.1.1": {
        "result": "–í–∏ –∑–Ω–∞—Ö–æ–¥–∏—Ç–µ –¥–æ—Å—Ç—É–ø –¥–æ —Ç–µ—Ö–Ω—ñ—á–Ω–æ–≥–æ –ª—ñ—Ñ—Ç–∞.",
        "scene": "roof_access",
        "next_choices": [
            "–ü—ñ–¥–Ω—è—Ç–∏—Å—å –Ω–∞ –¥–∞—Ö –∑–∞—Ä–∞–∑",
            "–ó–∞–º—ñ–Ω—É–≤–∞—Ç–∏ –ª—ñ—Ñ—Ç",
            "–í—ñ–¥–∫–ª–∞—Å—Ç–∏ –¥–∞—Ö —ñ –ø–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—å",
            "–ü–µ—Ä–µ–¥–∞—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø–æ–ª—ñ—Ü—ñ—ó"
        ]
    },
    "2.1.2": {
        "result": "–°–µ–π—Ñ ‚Äî –ø–∞—Å—Ç–∫–∞, –∞–ª–µ –∑ —Ü—ñ–Ω–Ω–∏–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏.",
        "scene": "safe_room",
        "next_choices": [
            "–†–∏–∑–∏–∫–Ω—É—Ç–∏ —ñ –≤—ñ–¥–∫—Ä–∏—Ç–∏",
            "–°–∞–±–æ—Ç—É–≤–∞—Ç–∏ –ø–∞—Å—Ç–∫—É",
            "–í—ñ–¥—ñ–π—Ç–∏",
            "–í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ —Å–µ–π—Ñ —è–∫ –ø—Ä–∏–º–∞–Ω–∫—É"
        ]
    },
    "2.1.3": {
        "result": "–í–∏ —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—î—Ç–µ —Ä—É—Ö –≤–æ—Ä–æ–≥—ñ–≤.",
        "scene": "shadow_wait",
        "next_choices": [
            "–ü—Ä–æ—Å–ª—ñ–¥–∫—É–≤–∞—Ç–∏ –∑–∞ –ø–∞—Ç—Ä—É–ª–µ–º",
            "–ê—Ç–∞–∫—É–≤–∞—Ç–∏ –∑ –∑–∞—Å—ñ–¥–∫–∏",
            "–ó–º—ñ–Ω–∏—Ç–∏ –ø–æ–≤–µ—Ä—Ö",
            "–ü—Ä–æ–¥–æ–≤–∂–∏—Ç–∏ —á–µ–∫–∞—Ç–∏"
        ]
    },
    "2.1.4": {
        "result": "–í–∏ –ø–æ—Ç—Ä–∞–ø–ª—è—î—Ç–µ –≤ –∑–æ–Ω—É –∑ –∑–∞—Ä—É—á–Ω–∏–∫–∞–º–∏.",
        "scene": "hostage_floor",
        "next_choices": [
            "–í–∏–∑–≤–æ–ª–∏—Ç–∏ —Ç–∏—Ö–æ",
            "–ü–µ—Ä–µ–¥–∞—Ç–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∏ –ø–æ–ª—ñ—Ü—ñ—ó",
            "–ü—Ä–æ—ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏ —ñ –π—Ç–∏ –¥–∞–ª—ñ",
            "–°—Ç–≤–æ—Ä–∏—Ç–∏ –≤—ñ–¥–≤–æ–ª—ñ–∫–∞–Ω–Ω—è"
        ]
    },
    "2.2.1": {
        "scene": "alternate_route",
        "next_choices": [
            "–û–±—Ö—ñ–¥ –¥–æ —Å–µ—Ä–≤–µ—Ä–Ω–æ—ó",
            "–ü—ñ–¥–π–æ–º –¥–æ –∫–µ—Ä—ñ–≤–Ω–æ–≥–æ –ø–æ–≤–µ—Ä—Ö—É",
            "–ü–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –≤ –æ—Ñ—ñ—Å–∏",
            "–ó–∞—Å—ñ–¥–∫–∞ –Ω–∞ –ø–∞—Ç—Ä—É–ª—å"
        ]
    },
    "2.2.2": {
        "scene": "tailing",
        "next_choices": [
            "–î–æ—á–µ–∫–∞—Ç–∏—Å—å –º–æ–º–µ–Ω—Ç—É",
            "–ü—ñ–¥—Å–ª—É—Ö–∞—Ç–∏ —Ä–∞—Ü—ñ—é",
            "–ê—Ç–∞–∫—É–≤–∞—Ç–∏",
            "–í—ñ–¥—ñ–π—Ç–∏"
        ]
    },
    "2.2.3": {
        "scene": "planned_ambush",
        "next_choices": [
            "–£–±–∏–≤—á–∏–π —É–¥–∞—Ä",
            "–ù–æ–∫–∞—É—Ç",
            "–í—ñ–¥—ñ–π—Ç–∏ –ø—ñ—Å–ª—è –ø–µ—Ä—à–æ–≥–æ —à—É–º—É",
            "–ó–º—ñ–Ω–∏—Ç–∏ –ø–æ–∑–∏—Ü—ñ—é"
        ]
    },
    "2.2.4": {
        "scene": "intel_bank",
        "next_choices": [
            "–û–±–º—ñ–Ω—è—Ç–∏ –Ω–∞ —Ä–µ—Å—É—Ä—Å",
            "–ü–µ—Ä–µ–¥–∞—Ç–∏ –ø–æ–ª—ñ—Ü—ñ—ó",
            "–ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ –≤ —Ñ—ñ–Ω–∞–ª—ñ",
            "–Ü–≥–Ω–æ—Ä—É–≤–∞—Ç–∏"
        ]
    },
    "2.3.1": {
        "scene": "cleanup",
        "next_choices": [
            "–ó–∞–ª–∏—à–∏—Ç–∏—Å—å –Ω–∞ –ø–æ–≤–µ—Ä—Ö—É",
            "–í—ñ–¥—ñ–π—Ç–∏",
            "–ü—ñ–¥–≥–æ—Ç—É–≤–∞—Ç–∏ –ø–∞—Å—Ç–∫—É",
            "–ó–∞—Ç–∞—ó—Ç–∏—Å—å"
        ]
    },
    "2.3.2": {
        "scene": "forced_move",
        "next_choices": [
            "–°–ø—É—Å—Ç–∏—Ç–∏—Å—å",
            "–ü—ñ–¥–Ω—è—Ç–∏—Å—å",
            "–í–µ–Ω—Ç–∏–ª—è—Ü—ñ—è",
            "–°—Ö–æ–¥–∏"
        ]
    },
    "2.3.3": {
        "scene": "defensive_hold",
        "next_choices": [
            "–¢—Ä–∏–º–∞—Ç–∏ –ø–æ–∑–∏—Ü—ñ—é",
            "–ó–∞–º–∞–Ω–∏—Ç–∏",
            "–í—ñ–¥—Å—Ç—É–ø",
            "–í–∏–±—É—Ö"
        ]
    },
    "2.3.4": {
        "scene": "early_combat",
        "next_choices": [
            "–ü—Ä–æ–¥–∞–≤–∏—Ç–∏",
            "–í—ñ–¥—Å—Ç—É–ø–∏—Ç–∏",
            "–ó–∞—Ö–æ–ø–∏—Ç–∏ –∑–±—Ä–æ—é",
            "–í—ñ–¥—ñ—Ä–≤–∞—Ç–∏—Å—å"
        ]
    },
    "2.4.1": {
        "scene": "vent_travel",
        "next_choices": [
            "–†–∏–∑–∏–∫–Ω—É—Ç–∏ —à–≤–∏–¥–∫–æ",
            "–ü–æ–≤—ñ–ª—å–Ω–æ —ñ –±–µ–∑–ø–µ—á–Ω–æ",
            "–í–∏–π—Ç–∏ —Ç—É—Ç",
            "–ü–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—å"
        ]
    },
    "2.4.2": {
        "scene": "rear_entry",
        "next_choices": [
            "–ê—Ç–∞–∫–∞",
            "–°–∞–±–æ—Ç–∞–∂",
            "–°—Ç–µ–ª—Å",
            "–í—ñ–¥—ñ–π—Ç–∏"
        ]
    },
    "2.4.3": {
        "scene": "radio_intercept",
        "next_choices": [
            "–ü–µ—Ä–µ–¥–∞—Ç–∏ –ø–æ–ª—ñ—Ü—ñ—ó",
            "–°–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏—Å—å —Å–∞–º–æ–º—É",
            "–î–µ–∑—ñ–Ω—Ñ–æ—Ä–º—É–≤–∞—Ç–∏",
            "–í–∏–º–∫–Ω—É—Ç–∏ —Ä–∞—Ü—ñ—é"
        ]
    },
    "2.4.4": {
        "scene": "core_access",
        "next_choices": [
            "–õ—ñ—Ñ—Ç–∏",
            "–°–µ—Ä–≤–µ—Ä–Ω–∞",
            "–î–∞—Ö",
            "–°—Ö–æ–≤–∏—â–µ"
        ]
    },
    "Alert.1.1": {
        "scene": "hunt_mode",
        "next_choices": [
            "–∑–Ω–∏–∫–Ω—É—Ç–∏",
            "–∫–æ–Ω—Ç—Ä–∞—Ç–∞–∫—É–≤–∞—Ç–∏",
            "—á–µ–∫–∞—Ç–∏"
        ]
    },
    "Alert.2.1": {
        "scene": "combat_chain",
        "next_choices": [
            "—Ç–∏—Å–Ω—É—Ç–∏",
            "–≤—ñ–¥—ñ–π—Ç–∏",
            "–∑–º—ñ–Ω–∏—Ç–∏ –ø–æ–∑–∏—Ü—ñ—é"
        ]
    },
    "Alert.3.1": {
        "scene": "combat_chain",
        "next_choices": [
            "–∞–≥—Ä–µ—Å—ñ—è",
            "–æ–±–æ—Ä–æ–Ω–∞",
            "–≤—Ç–µ—á–∞"
        ]
    },
    "Alert.4.1": {
        "scene": "stealth_reset",
        "next_choices": [
            "–¥–∞—Ö",
            "—Å–µ—Ä–≤–µ—Ä–Ω–∞",
            "–∑–∞—Ä—É—á–Ω–∏–∫–∏"
        ]
    },
    "3.1": {
        "result": "–°–∏–≥–Ω–∞–ª —Å—Ç–∞–±—ñ–ª—å–Ω–∏–π, –∞–ª–µ –≤–æ—Ä–æ–≥–∏ –π–æ–≥–æ –≤—ñ–¥—Å—Ç–µ–∂—É—é—Ç—å.",
        "scene": "signal_trace",
        "next_choices": [
            "–ó–∞–ª–∏—à–∏—Ç–∏—Å—å —ñ –¥–æ–≥—Ä–∞—Ç–∏ –ø–µ—Ä–µ–¥–∞—á—É",
            "–ü–µ—Ä–µ–¥–∞–≤–∞—Ç–∏ —ñ —Ä—É—Ö–∞—Ç–∏—Å—å",
            "–°–ø–µ—Ü—ñ–∞–ª—å–Ω–æ –∑–∞—Å–≤—ñ—Ç–∏—Ç–∏—Å—å",
            "–†—ñ–∑–∫–æ –æ–±—ñ—Ä–≤–∞—Ç–∏ –∑–≤‚Äô—è–∑–æ–∫"
        ]
    },
    "3.1.1": {
        "scene": "fixed_transmission",
        "result": "–ü–æ–ª—ñ—Ü—ñ—è –∑–Ω–∞—î –≤—Å–µ. –¢–µ—Ä–æ—Ä–∏—Å—Ç–∏ ‚Äî –º–∞–π–∂–µ —Ç–µ–∂.",
        "next_choices": [
            "–ü—ñ–¥–≥–æ—Ç—É–≤–∞—Ç–∏ –æ–±–æ—Ä–æ–Ω—É (Alert.2)",
            "–°–ø—Ä–æ–±—É–≤–∞—Ç–∏ –∑–Ω–∏–∫–Ω—É—Ç–∏ (Alert.4)",
            "–ó–∞–ª–∏—à–∏—Ç–∏—Å—å —ñ –ø—Ä–∏–π–Ω—è—Ç–∏ –±—ñ–π (Alert.3)",
            "–†—ñ–∑–∫–æ –∑–º—ñ–Ω–∏—Ç–∏ –ø–æ–≤–µ—Ä—Ö"
        ]
    },
    "3.1.2": {
        "scene": "mobile_transmission",
        "result": "–°–∫–ª–∞–¥–Ω—ñ—à–µ –≤—ñ–¥—Å—Ç–µ–∂–∏—Ç–∏, –∞–ª–µ –±—ñ–ª—å—à–µ —à—É–º—É.",
        "next_choices": [
            "–ü—ñ—Ç–∏ –≤ –≤–µ–Ω—Ç–∏–ª—è—Ü—ñ—é",
            "–°–ø—É—Å—Ç–∏—Ç–∏—Å—å —Å—Ö–æ–¥–∞–º–∏",
            "–ó–∞–π—Ç–∏ –≤ –æ—Ñ—ñ—Å–∏",
            "–í–∏–π—Ç–∏ –Ω–∞ –≤—ñ–¥–∫—Ä–∏—Ç—É –∑–æ–Ω—É"
        ]
    },
    "3.1.3": {
        "scene": "decoy_signal",
        "result": "–í–∏ ‚Äî –Ω–∞–∂–∏–≤–∫–∞. –ß–∞—Å—Ç–∏–Ω–∞ –≤–æ—Ä–æ–≥—ñ–≤ —ñ–¥–µ –Ω–∞ –≤–∞—Å.",
        "next_choices": [
            "–ó–∞–º–∞–Ω–∏—Ç–∏ –≤ –ø–∞—Å—Ç–∫—É",
            "–í–¥–∞—Ä–∏—Ç–∏ –ø–µ—Ä—à–∏–º–∏",
            "–ó–Ω–∏–∫–Ω—É—Ç–∏ –≤ –º–æ–º–µ–Ω—Ç –∫–æ–Ω—Ç–∞–∫—Ç—É",
            "–ü–æ—Ç—è–≥–Ω—É—Ç–∏ —á–∞—Å –¥–ª—è –ø–æ–ª—ñ—Ü—ñ—ó"
        ]
    },
    "3.1.4": {
        "scene": "signal_cut",
        "result": "–í–æ—Ä–æ–≥–∏ –≥—É–±–ª—è—Ç—å —Å–ª—ñ–¥, –ø–æ–ª—ñ—Ü—ñ—è ‚Äî –±–µ–∑ –Ω–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö.",
        "next_choices": [
            "–ü—ñ—Ç–∏ –≤ —Å—Ç–µ–ª—Å",
            "–ü–µ—Ä–µ–º—ñ—Å—Ç–∏—Ç–∏—Å—å –±–ª–∏–∂—á–µ –¥–æ —Ü—ñ–ª—ñ",
            "–°–ø—Ä–æ–±—É–≤–∞—Ç–∏ –ø–æ–≤—Ç–æ—Ä–Ω–∏–π –∫–æ–Ω—Ç–∞–∫—Ç –ø—ñ–∑–Ω—ñ—à–µ",
            "–ü—ñ–¥–≥–æ—Ç—É–≤–∞—Ç–∏ –∑–∞—Å—ñ–¥–∫—É"
        ]
    },
    "3.2": {
        "scene": "empty_trace",
        "result": "–í–æ—Ä–æ–≥–∏ –ø—Ä–∏—Ö–æ–¥—è—Ç—å —É –ø–æ—Ä–æ–∂–Ω—é —Ç–æ—á–∫—É.",
        "next_choices": [
            "–°–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏—Å—å –∑–∞—Ç—Ä–∏–º–∫–æ—é",
            "–ü—Ä–æ—Å–ª—ñ–¥–∫—É–≤–∞—Ç–∏ –∑–∞ –∑–∞–≥–æ–Ω–æ–º",
            "–í–¥–∞—Ä–∏—Ç–∏ –∑ —Ç–∏–ª—É",
            "–ü–æ–≤–Ω—ñ—Å—Ç—é –∑–Ω–∏–∫–Ω—É—Ç–∏"
        ]
    },
    "3.2.1": {
        "scene": "time_window",
        "next_choices": [
            "–ë—ñ–≥—Ç–∏ –¥–æ –¥–∞—Ö—É",
            "–°–∞–±–æ—Ç—É–≤–∞—Ç–∏ —Å–∏—Å—Ç–µ–º–∏",
            "–í–∏–∑–≤–æ–ª—è—Ç–∏ –∑–∞—Ä—É—á–Ω–∏–∫—ñ–≤",
            "–ì–æ—Ç—É–≤–∞—Ç–∏—Å—å –¥–æ —Ñ—ñ–Ω–∞–ª—É"
        ]
    },
    "3.2.2": {
        "scene": "counter_tail",
        "next_choices": [
            "–ê—Ç–∞–∫—É–≤–∞—Ç–∏ –∫–æ–º–∞–Ω–¥–∏—Ä–∞",
            "–ó–∞–ø–∞–º‚Äô—è—Ç–∞—Ç–∏ –º–∞—Ä—à—Ä—É—Ç–∏",
            "–ü—ñ—Ç–∏ —ñ–Ω—à–∏–º —à–ª—è—Ö–æ–º",
            "–í—ñ–¥—ñ–π—Ç–∏"
        ]
    },
    "3.2.3": {
        "scene": "rear_strike",
        "next_choices": [
            "–®–≤–∏–¥–∫–µ –¥–æ–±–∏–≤–∞–Ω–Ω—è",
            "–í—ñ–¥—ñ–π—Ç–∏ –ø—ñ—Å–ª—è —É–¥–∞—Ä—É",
            "–ó–∞–±—Ä–∞—Ç–∏ —Å–ø–æ—Ä—è–¥–∂–µ–Ω–Ω—è",
            "–°—Ö–æ–≤–∞—Ç–∏—Å—å"
        ]
    },
    "3.2.4": {
        "scene": "ghost_mode",
        "next_choices": [
            "–ß–∏—Å—Ç–∏–π —Å—Ç–µ–ª—Å –¥–æ —Ñ—ñ–Ω–∞–ª—É",
            "–°–∞–±–æ—Ç–∞–∂ + –∑–Ω–∏–∫–Ω–µ–Ω–Ω—è",
            "–¢–æ—á–∫–æ–≤—ñ —É–¥–∞—Ä–∏",
            "–û—á—ñ–∫—É–≤–∞–Ω–Ω—è —à—Ç—É—Ä–º—É"
        ]
    },
    "3.3": {
        "scene": "misinformation",
        "result": "–£—Å—ñ –≥—Ä–∞—é—Ç—å —É —à–∞—Ö–∏, –∞–ª–µ –∑ –∫—Ä–∏–≤–æ—é –¥–æ—à–∫–æ—é.",
        "next_choices": [
            "–°–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏—Å—å —Ä–æ–∑–¥—ñ–ª–µ–Ω–Ω—è–º –≤–æ—Ä–æ–≥—ñ–≤",
            "–í–∏–ø—Ä–∞–≤–∏—Ç–∏ –¥–∞–Ω—ñ –ø–æ–ª—ñ—Ü—ñ—ó",
            "–ü–æ–≥–ª–∏–±–∏—Ç–∏ –¥–µ–∑—ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é",
            "–ó–∞–º–æ–≤–∫–Ω—É—Ç–∏"
        ]
    },
    "3.3.1": {
        "scene": "split_enemies",
        "next_choices": [
            "–ü–æ–ª—é–≤–∞–Ω–Ω—è –ø–æ–æ–¥–∏–Ω—Ü—ñ",
            "–°–∞–±–æ—Ç–∞–∂ –∫–ª—é—á–æ–≤–æ—ó —Ç–æ—á–∫–∏",
            "–ü—Ä–æ—Ö—ñ–¥ –¥–æ —Ñ—ñ–Ω–∞–ª—å–Ω–æ—ó –∑–æ–Ω–∏",
            "–í—ñ–¥—Ö—ñ–¥"
        ]
    },
    "3.3.2": {
        "scene": "data_correction",
        "next_choices": [
            "–ü–æ–≤–Ω–∏–π –±—Ä–∏—Ñ—ñ–Ω–≥ –ø–æ–ª—ñ—Ü—ñ—ó",
            "–ú—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π –∞–ø–¥–µ–π—Ç",
            "–†–∏–∑–∏–∫–æ–≤–∞–Ω–∏–π —Å–∏–≥–Ω–∞–ª",
            "–û–±—ñ—Ä–≤–∞—Ç–∏ –∫–æ–Ω—Ç–∞–∫—Ç"
        ]
    },
    "3.3.3": {
        "scene": "chaos_control",
        "next_choices": [
            "–ü–µ—Ä–µ–º—ñ—Å—Ç–∏—Ç–∏—Å—å —É —Ç–∏–ª",
            "–ó–Ω–∏—â–∏—Ç–∏ –ª—ñ–¥–µ—Ä–∞",
            "–í–∏–π—Ç–∏ –Ω–∞ –¥–∞—Ö",
            "–ß–µ–∫–∞—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤"
        ]
    },
    "3.3.4": {
        "scene": "silent_aftermath",
        "next_choices": [
            "–°—Ç–µ–ª—Å",
            "–°–∞–±–æ—Ç–∞–∂",
            "–ê—Ç–∞–∫–∞",
            "–û—á—ñ–∫—É–≤–∞–Ω–Ω—è"
        ]
    },
    "3.4": {
        "scene": "no_support",
        "result": "–¢—ñ–ª—å–∫–∏ —Ç–∏ –π –±—É–¥—ñ–≤–ª—è.",
        "next_choices": [
            "–°–∏—Å—Ç–µ–º–Ω–∏–π —Å–∞–±–æ—Ç–∞–∂",
            "–ú–µ—Ç–æ–¥–∏—á–Ω–µ –∑–Ω–∏—â–µ–Ω–Ω—è –≤–æ—Ä–æ–≥—ñ–≤",
            "–ü–æ–≤–Ω–µ —É–Ω–∏–∫–∞–Ω–Ω—è",
            "–ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ñ—ñ–Ω–∞–ª—å–Ω–æ—ó –ø–∞—Å—Ç–∫–∏"
        ]
    },
    "3.4.1": {
        "scene": "infrastructure_attack",
        "next_choices": [
            "–°–≤—ñ—Ç–ª–æ",
            "–õ—ñ—Ñ—Ç–∏",
            "–ó–≤‚Äô—è–∑–æ–∫",
            "–í–∏–±—É—Ö–∏"
        ]
    },
    "3.4.2": {
        "scene": "solo_hunt",
        "next_choices": [
            "–ü–æ –æ–¥–Ω–æ–º—É",
            "–ó–∞—Å—ñ–¥–∫–∏",
            "–®–≤–∏–¥–∫—ñ —É–¥–∞—Ä–∏",
            "–í—ñ–¥—Ö—ñ–¥"
        ]
    },
    "3.4.3": {
        "scene": "pure_survival",
        "next_choices": [
            "–í–µ–Ω—Ç–∏–ª—è—Ü—ñ—è",
            "–ó–∞–∫—Ä–∏—Ç—ñ –∑–æ–Ω–∏",
            "–û—á—ñ–∫—É–≤–∞–Ω–Ω—è",
            "–ü–æ–≤—ñ–ª—å–Ω–∏–π —Ä—É—Ö"
        ]
    },
    "3.4.4": {
        "scene": "final_setup",
        "next_choices": [
            "–î–∞—Ö",
            "–°–µ—Ä–≤–µ—Ä–Ω–∞",
            "–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∏–π —Ö–æ–ª",
            "–°—Ö–æ–¥–∏"
        ]
    }
}

def get_scene_node(node_id):
    return scene_graph.get(node_id, {})

def main():
    char = choose_character()
    player = init_player(char)
    action = first_scene(player)
    player = process_first_scene_choice(player, action)
    print("\n--- –°—Ç–∞–Ω –≥—Ä–∞–≤—Ü—è –ø—ñ—Å–ª—è –¥—ñ—ó ---")
    for k, v in player.items():
        print(f"{k}: {v}")
    if player.get("ending") == "coward_escape":
        print("\n–ì—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞.")
        return
    if player.get("location") == "office_floor":
        player = scene2_office_floor(player)
    elif player.get("radio_used"):
        player = scene3_radio_branch(player)
    player = check_alert_mode(player)
    print("\n--- –°—Ç–∞–Ω –≥—Ä–∞–≤—Ü—è –ø—ñ—Å–ª—è —Å—Ü–µ–Ω–∏ 2/3 ---")
    for k, v in player.items():
        print(f"{k}: {v}")

if __name__ == "__main__":
    main()